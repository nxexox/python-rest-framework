<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    
        <meta name="description" content="Python Rest Framework - Web APIs for Python">
    
    
        <meta name="author" content="Deys Timofey">
    
    
        <link rel="canonical" href="https://nxexox.github.io/python-rest-framework/api-guid/serializers/">
    
    <link rel="shortcut icon" href="../../img/favicon.ico">

    <title>Serializers - Python Rest Framework</title>

    <link href="../../css/bootstrap-custom.min.css" rel="stylesheet">
    <link href="//maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet">
    <link rel="stylesheet" href="//cdn.jsdelivr.net/font-hack/2.018/css/hack.min.css">
    <link href='//fonts.googleapis.com/css?family=PT+Sans:400,400italic,700,700italic&subset=latin-ext,latin' rel='stylesheet' type='text/css'>
    <link href='//fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,700italic,400,300,600,700&subset=latin-ext,latin' rel='stylesheet' type='text/css'>
    <link href="../../css/base.css" rel="stylesheet">
    <link href="../../css/cinder.css" rel="stylesheet">
    <link rel="stylesheet" href="../../css/highlight.css">

    <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
            <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
            <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->

    <script src="https://ajax.googleapis.com/ajax/libs/webfont/1.5.18/webfont.js"></script>
    <script>
    WebFont.load({
        google: {
            families: ['Open Sans', 'PT Sans']
        }
    });
    </script>

    
</head>

<body>

    <div class="navbar navbar-default navbar-fixed-top" role="navigation">
    <div class="container">

        <!-- Collapsed navigation -->
        <div class="navbar-header">
            <!-- Expander button -->
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            

            <!-- Main title -->

            <a class="navbar-brand" href="../..">Python Rest Framework</a>
        </div>

        <!-- Expanded navigation -->
        <div class="navbar-collapse collapse">
                <!-- Main navigation -->
                <ul class="nav navbar-nav">
                
                
                    <li >
                        <a href="../..">Home</a>
                    </li>
                
                
                
                    <li class="dropdown active">
                        <a href="#" class="dropdown-toggle" data-toggle="dropdown">API <b class="caret"></b></a>
                        <ul class="dropdown-menu">
                        
                            
<li >
    <a href="../fields/">Serializer fields</a>
</li>

                        
                            
<li class="active">
    <a href="./">Serializers</a>
</li>

                        
                            
<li >
    <a href="../validators/">Validation</a>
</li>

                        
                        </ul>
                    </li>
                
                
                
                    <li >
                        <a href="../../release-notes/">Release Notes</a>
                    </li>
                
                
                </ul>

            <ul class="nav navbar-nav navbar-right">
                    <li>
                        <a href="#" data-toggle="modal" data-target="#mkdocs_search_modal">
                            <i class="fa fa-search"></i> Search
                        </a>
                    </li>
                    <li >
                        <a rel="next" href="../fields/">
                            <i class="fa fa-arrow-left"></i> Previous
                        </a>
                    </li>
                    <li >
                        <a rel="prev" href="../validators/">
                            Next <i class="fa fa-arrow-right"></i>
                        </a>
                    </li>
                    <li>
                        <a href="https://github.com/blob/master/docs/api-guid/serializers.md"><i class="fa fa-github"></i> Edit on GitHub</a>
                    </li>
                    <li>
                        <a href="https://github.com/nxexox/python-rest-framework/"><i class="fa fa-github"></i> GitHub</a>
                    </li>
            </ul>
        </div>
    </div>
</div>

    <div class="container">
        
        <div class="col-md-3"><div class="bs-sidebar hidden-print affix well" role="complementary">
    <ul class="nav bs-sidenav">
        <li class="first-level active"><a href="#serializers">Serializers</a></li>
            <li class="second-level"><a href="#declaring-serializers">Declaring Serializers</a></li>
                
            <li class="second-level"><a href="#serializing-objects">Serializing objects</a></li>
                
            <li class="second-level"><a href="#deserializing-objects">Deserializing objects</a></li>
                
            <li class="second-level"><a href="#validation">Validation</a></li>
                
                <li class="third-level"><a href="#raising-an-exception-on-invalid-data">Raising an exception on invalid data</a></li>
                <li class="third-level"><a href="#field-level-validation">Field-level validation</a></li>
                <li class="third-level"><a href="#object-level-validation">Object-level validation</a></li>
                <li class="third-level"><a href="#validators">Validators</a></li>
            <li class="second-level"><a href="#accessing-the-initial-data-and-instance">Accessing the initial data and instance</a></li>
                
            <li class="second-level"><a href="#dealing-with-nested-objects">Dealing with nested objects</a></li>
                
            <li class="second-level"><a href="#writable-nested-representations">Writable nested representations</a></li>
                
        <li class="first-level "><a href="#baseserializer">BaseSerializer</a></li>
        <li class="first-level "><a href="#advanced-serializer-usage">Advanced serializer usage</a></li>
            <li class="second-level"><a href="#overriding-serialization-and-deserialization-behavior">Overriding serialization and deserialization behavior</a></li>
                
                <li class="third-level"><a href="#-to_representationself-instance">- .to_representation(self, instance)</a></li>
                <li class="third-level"><a href="#-to_internal_valueself-data">- .to_internal_value(self, data)</a></li>
            <li class="second-level"><a href="#serializer-inheritance">Serializer Inheritance</a></li>
                
            <li class="second-level"><a href="#dynamically-modifying-fields">Dynamically modifying fields</a></li>
                
    </ul>
</div></div>
        <div class="col-md-9" role="main">

<h1 id="serializers"><a class="toclink" href="#serializers">Serializers</a></h1>
<p>Serializers allow complex data such as querysets and model instances to be converted to native Python datatypes that can then be easily rendered into <code>JSON</code>, <code>XML</code> or other content types.  Serializers also provide deserialization, allowing parsed data to be converted back into complex types, after first validating the incoming data.</p>
<h2 id="declaring-serializers"><a class="toclink" href="#declaring-serializers">Declaring Serializers</a></h2>
<p>Let&rsquo;s start by creating a simple object we can use for example:</p>
<pre><code>from datetime import datetime

class Comment(object):
    def __init__(self, author_name, content, created=False):
        self.author_name = author_name
        self.content = content
        self.created = bool(created)

comment = Comment(author_name='example_name', content='foo bar')
</code></pre>
<p>We&rsquo;ll declare a serializer that we can use to serialize and deserialize data that corresponds to <code>Comment</code> objects.</p>
<pre><code>from rest_framework import serializers

class CommentSerializer(serializers.Serializer):
    author_name = serializers.CharField(required=True)
    content = serializers.CharField(max_length=200)
    created = serializers.BooleanField(required=True)
</code></pre>
<hr />
<h2 id="serializing-objects"><a class="toclink" href="#serializing-objects">Serializing objects</a></h2>
<p>We can now use <code>CommentSerializer</code> to serialize a comment, or list of comments.</p>
<pre><code>serializer = CommentSerializer(comment)
serializer.data
# {'author_name': 'example_name', 'content': 'foo bar', 'created': False}
</code></pre>
<p>At this point we&rsquo;ve translated the model instance into Python native datatypes.  To finalise the serialization process we render the data into <code>json</code>.</p>
<pre><code>from rest_framework.renderers import JSONRenderer

json = JSONRenderer().render(serializer.data)
json
# b'{"author_name":"example","content":"foo bar","created":false}'
</code></pre>
<hr />
<h2 id="deserializing-objects"><a class="toclink" href="#deserializing-objects">Deserializing objects</a></h2>
<p>Deserialization is similar. First we parse a stream into Python native datatypes&hellip;</p>
<pre><code>import io
from rest_framework.parsers import JSONParser

stream = io.BytesIO(json)
data = JSONParser().parse(stream)
</code></pre>
<p>&hellip;then we restore those native datatypes into a dictionary of validated data.</p>
<pre><code>serializer = CommentSerializer(data=data)
serializer.is_valid()
# True
serializer.validated_data
# {'content': 'foo bar', 'author_name': 'example', 'created': False)}
</code></pre>
<hr />
<h2 id="validation"><a class="toclink" href="#validation">Validation</a></h2>
<p>When deserializing data, you always need to call <code>is_valid()</code> before attempting to access the validated data. If any validation errors occur, the <code>.errors</code> property will contain a dictionary representing the resulting error messages.  For example:</p>
<pre><code>serializer = CommentSerializer(data={'author_name': 'foobar', 'content': 'baz'})
serializer.is_valid()
# False
serializer.errors
# {'author_name': [u'This field is required.'], 'created': [u'This field is required.']}
</code></pre>
<p>Each key in the dictionary will be the field name, and the values will be lists of strings of any error messages corresponding to that field.  The <code>non_field_errors</code> key may also be present, and will list any general validation errors.</p>
<p>When deserializing a list of items, errors will be returned as a list of dictionaries representing each of the deserialized items.</p>
<h3 id="raising-an-exception-on-invalid-data"><a class="toclink" href="#raising-an-exception-on-invalid-data">Raising an exception on invalid data</a></h3>
<p>The <code>.is_valid()</code> method takes an optional <code>raise_exception</code> flag that will cause it to raise a <code>serializers.ValidationError</code> exception if there are validation errors.</p>
<pre><code>try:
    serializer.is_valid(raise_exception=True)
except ValidationError:
    print(serializer.errors)
</code></pre>
<hr />
<h3 id="field-level-validation"><a class="toclink" href="#field-level-validation">Field-level validation</a></h3>
<p>You can specify custom field-level validation by adding <code>.validate_&lt;field_name&gt;</code> methods to your <code>Serializer</code> subclass.</p>
<p>These methods take a single argument, which is the field value that requires validation.</p>
<p>Your <code>validate_&lt;field_name&gt;</code> methods should return the validated value or raise a <code>serializers.ValidationError</code>.  For example:</p>
<pre><code>from rest_framework import serializers

class BlogPostSerializer(serializers.Serializer):
    title = serializers.CharField(max_length=100)
    content = serializers.CharField()

    def validate_title(self, value):
        """
        Check that the blog post is about Django.

        """
        if 'rest' not in value.lower():
            raise serializers.ValidationError("Blog post is not about Rest")
        return value
</code></pre>
<hr />
<h3 id="object-level-validation"><a class="toclink" href="#object-level-validation">Object-level validation</a></h3>
<p>To do any other validation that requires access to multiple fields, add a method called <code>.validate()</code> to your <code>Serializer</code> subclass.  This method takes a single argument, which is a dictionary of field values.  It should raise a <code>serializers.ValidationError</code> if necessary, or just return the validated values.  For example:</p>
<pre><code>from rest_framework import serializers

class EventSerializer(serializers.Serializer):
    description = serializers.CharField(max_length=100)
    start = serializers.IntegerField()
    finish = serializers.IntegerField()

    def validate(self, data):
        """
        Check that the start is before the stop.

        """
        if data['start'] &gt; data['finish']:
            raise serializers.ValidationError("finish must occur after start")
        return data
</code></pre>
<hr />
<h3 id="validators"><a class="toclink" href="#validators">Validators</a></h3>
<p>Individual fields on a serializer can include validators, by declaring them on the field instance, for example:</p>
<pre><code>def multiple_of_ten(value):
    if value % 10 != 0:
        raise serializers.ValidationError('Not a multiple of ten')

class GameRecord(serializers.Serializer):
    score = IntegerField(validators=[multiple_of_ten])
    ...
</code></pre>
<p>For more information see the <a href="../validators/">validators documentation</a>.</p>
<hr />
<h2 id="accessing-the-initial-data-and-instance"><a class="toclink" href="#accessing-the-initial-data-and-instance">Accessing the initial data and instance</a></h2>
<p>When passing an initial object or queryset to a serializer instance, the object will be made available as <code>.instance</code>. If no initial object is passed then the <code>.instance</code> attribute will be <code>None</code>.</p>
<p>When passing data to a serializer instance, the unmodified data will be made available as <code>.initial_data</code>. If the data keyword argument is not passed then the <code>.initial_data</code> attribute will not exist.</p>
<hr />
<h2 id="dealing-with-nested-objects"><a class="toclink" href="#dealing-with-nested-objects">Dealing with nested objects</a></h2>
<p>The previous examples are fine for dealing with objects that only have simple datatypes, but sometimes we also need to be able to represent more complex objects, where some of the attributes of an object might not be simple datatypes such as strings, dates or integers.</p>
<p>The <code>Serializer</code> class is itself a type of <code>Field</code>, and can be used to represent relationships where one object type is nested inside another.</p>
<pre><code>class UserSerializer(serializers.Serializer):
    email = serializers.CharField(required=True)
    username = serializers.CharField(max_length=100)

class CommentSerializer(serializers.Serializer):
    user = UserSerializer()
    content = serializers.CharField(max_length=200)
</code></pre>
<p>If a nested representation may optionally accept the <code>None</code> value you should pass the <code>required=False</code> flag to the nested serializer.</p>
<pre><code>class CommentSerializer(serializers.Serializer):
    user = UserSerializer(required=False)  # May be an anonymous user.
    content = serializers.CharField(max_length=200)
</code></pre>
<p>Similarly if a nested representation should be a list of items, you should pass the <code>many=True</code> flag to the nested serialized.</p>
<pre><code>class CommentSerializer(serializers.Serializer):
    user = UserSerializer(required=False)
    edits = UserSerializer(many=True)  # A nested list of 'user' items.
    content = serializers.CharField(max_length=200)
</code></pre>
<hr />
<h2 id="writable-nested-representations"><a class="toclink" href="#writable-nested-representations">Writable nested representations</a></h2>
<p>When dealing with nested representations that support deserializing the data, any errors with nested objects will be nested under the field name of the nested object.</p>
<pre><code>serializer = CommentSerializer(data={'user': {'username': 'doe'}, 'content': 'baz'})
serializer.is_valid()
# False
serializer.errors
# {'user': {'email': [u'Enter a valid e-mail address.']}}
</code></pre>
<p>Similarly, the <code>.validated_data</code> property will include nested data structures.</p>
<hr />
<h1 id="baseserializer"><a class="toclink" href="#baseserializer">BaseSerializer</a></h1>
<p><code>BaseSerializer</code> class that can be used to easily support alternative serialization and deserialization styles.</p>
<p>This class implements the same basic API as the <code>Serializer</code> class:</p>
<ul>
<li><code>.data</code> - Returns the outgoing primitive representation.</li>
</ul>
<p>There are five methods that can be overridden, depending on what functionality you want the serializer class to support:</p>
<ul>
<li><code>.to_representation()</code> - Override this to support serialization, for read operations.</li>
<li><code>.to_internal_value()</code> - Override this to support deserialization, for write operations.</li>
<li><code>.is_valid()</code> - Deserializes and validates incoming data.</li>
<li><code>.validated_data</code> - Returns the validated incoming data.</li>
<li><code>.errors</code> - Returns any errors during validation.</li>
</ul>
<p>Because this class provides the same interface as the <code>Serializer</code> class, you can use it with the existing generic class-based views exactly as you would for a regular <code>Serializer</code>.</p>
<hr />
<h1 id="advanced-serializer-usage"><a class="toclink" href="#advanced-serializer-usage">Advanced serializer usage</a></h1>
<h2 id="overriding-serialization-and-deserialization-behavior"><a class="toclink" href="#overriding-serialization-and-deserialization-behavior">Overriding serialization and deserialization behavior</a></h2>
<p>If you need to alter the serialization or deserialization behavior of a serializer class, you can do so by overriding the <code>.to_representation()</code> or <code>.to_internal_value()</code> methods.</p>
<p>Some reasons this might be useful include&hellip;</p>
<ul>
<li>Adding new behavior for new serializer base classes.</li>
<li>Modifying the behavior slightly for an existing class.</li>
<li>Improving serialization performance for a frequently accessed API endpoint that returns lots of data.</li>
</ul>
<p>The signatures for these methods are as follows:</p>
<hr />
<h3 id="-to_representationself-instance"><a class="toclink" href="#-to_representationself-instance">- <code>.to_representation(self, instance)</code></a></h3>
<p>Takes the object instance that requires serialization, and should return a primitive representation. Typically this means returning a structure of built-in Python datatypes. The exact types that can be handled will depend on the render classes you have configured for your API.</p>
<p>May be overridden in order modify the representation style. For example:</p>
<pre><code>def to_representation(self, instance):
    """Convert `username` to lowercase."""
    ret = super().to_representation(instance)
    ret['username'] = ret['username'].lower()
    return ret
</code></pre>
<hr />
<h3 id="-to_internal_valueself-data"><a class="toclink" href="#-to_internal_valueself-data">- <code>.to_internal_value(self, data)</code></a></h3>
<p>Takes the unvalidated incoming data as input and should return the validated data that will be made available as <code>serializer.validated_data</code>.</p>
<p>If any of the validation fails, then the method should raise a <code>serializers.ValidationError(errors)</code>. The <code>errors</code> argument should be a dictionary mapping field names (or <code>non_field_errors</code>) to a list of error messages. If you don&rsquo;t need to alter deserialization behavior and instead want to provide object-level validation, it&rsquo;s recommended that you instead override the <a href="#object-level-validation"><code>.validate()</code></a> method.</p>
<p>The <code>data</code> argument passed to this method will normally be the value of <code>request.data</code>, so the datatype it provides will depend on the parser classes you have configured for your API.</p>
<hr />
<h2 id="serializer-inheritance"><a class="toclink" href="#serializer-inheritance">Serializer Inheritance</a></h2>
<p>You can extend and reuse serializers through inheritance. This allows you to declare a common set of fields or methods on a parent class that can then be used in a number of serializers. For example,</p>
<pre><code>class MyBaseSerializer(Serializer):
    my_field = serializers.CharField()

    def validate_my_field(self, value):
        ...

class MySerializer(MyBaseSerializer):
    ...
</code></pre>
<p>Itâ€™s possible to declaratively remove a <code>Field</code> inherited from a parent class by setting the name to be <code>None</code> on the subclass.</p>
<pre><code>class MyBaseSerializer(ModelSerializer):
    my_field = serializers.CharField()

class MySerializer(MyBaseSerializer):
    my_field = None
</code></pre>
<h2 id="dynamically-modifying-fields"><a class="toclink" href="#dynamically-modifying-fields">Dynamically modifying fields</a></h2>
<p>Once a serializer has been initialized, the dictionary of fields that are set on the serializer may be accessed using the <code>.fields</code> attribute.  Accessing and modifying this attribute allows you to dynamically modify the serializer.</p>
<p>Modifying the <code>fields</code> argument directly allows you to do interesting things such as changing the arguments on serializer fields at runtime, rather than at the point of declaring the serializer.</p>
<hr /></div>
        
    </div>

    <footer class="col-md-12 text-center">
        <hr>
        <p>
        <small>Copyright (c) 2018, Deys Timofey All rights reserved.<br></small>
        
        <small>Documentation built with <a href="http://www.mkdocs.org/">MkDocs</a>.</p></small>
    </footer>

    <script src="../../js/jquery-1.10.2.min.js"></script>
    <script src="../../js/bootstrap-3.0.3.min.js"></script>
    <script src="../../js/highlight.pack.js"></script>
    <script>hljs.initHighlightingOnLoad();</script>
    <script>
    var base_url = '../..';
    </script>
    <script data-main="../../mkdocs/js/search.js" src="../../mkdocs/js/require.js"></script>
    <script src="../../js/base.js"></script>
    <script src="../../search/main.js"></script>

    <div class="modal" id="mkdocs_search_modal" tabindex="-1" role="dialog" aria-labelledby="Search Modal" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal">
                        <span aria-hidden="true">&times;</span>
                        <span class="sr-only">Close</span>
                    </button>
                    <h4 class="modal-title" id="exampleModalLabel">Search</h4>
                </div>
                <div class="modal-body">
                    <p>
                        From here you can search these documents. Enter your search terms below.
                    </p>
                    <form role="form">
                        <div class="form-group">
                            <input type="text" class="form-control" placeholder="Search..." id="mkdocs-search-query">
                        </div>
                    </form>
                    <div id="mkdocs-search-results"></div>
                </div>
                <div class="modal-footer">
                </div>
            </div>
        </div>
    </div>

    </body>

</html>
